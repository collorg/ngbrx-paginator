<div *ngIf="pagination$ | async as pagination">
  <div class="row stick-to-the-top">
    <div class="col">
      <ngb-pagination
        [collectionSize]="(collection$ | async)?.length || 0"
        [(page)]="page"
        (pageChange)="changePage(page)"
        [pageSize]="pagination.pageSize"
        [boundaryLinks]="true"
      >
        <ng-template ngbPaginationPages let-page let-pages="pages">
          <li class="ngb-custom-pages-item" *ngIf="pages.length > 0">
            <div class="mb-3 d-flex flex-nowrap px-2">
              <label
                id="paginationInputLabel"
                for="paginationInput"
                class="col-form-label me-2 ms-1"
                >Page</label
              >
              <input
                #i
                type="text"
                inputmode="numeric"
                pattern="[0-9]*"
                class="form-control custom-pages-input"
                id="paginationInput"
                [value]="pagination.page"
                (keyup.enter)="setPage(i.value)"
                (blur)="setPage(i.value)"
                (input)="formatInput($any($event).target)"
                aria-labelledby="paginationInputLabel paginationDescription"
                style="width: 5rem"
              />
              <span
                id="paginationDescription"
                class="col-form-label text-nowrap px-2"
              >
                of {{ pagesCount$ | async }}</span
              >
            </div>
          </li>
        </ng-template>
      </ngb-pagination>
    </div>
    <div class="col dropdown">
      <button
        class="btn dropdown-toggle"
        id="dropdownMenuButton"
        data-bs-toggle="dropdown"
        aria-expanded="false"
      >
        {{ pagination.pageSize }} lines/page
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <li
          *ngFor="let pageSize of pagination.pageSizeOptions"
          class="dropdown-item"
          value="{{ pageSize }}"
          (click)="setPageSize(pageSize)"
        >
          {{ pageSize }} lines
        </li>
      </ul>
    </div>
  </div>
  <div class="row" *ngIf="filterKeys as filterKeys">
    <div
      *ngFor="let filterKey of filterKeys; index as idx"
      class="col input-group"
    >
      <div class="input-group-text">
        <input
          class="form-check-input mt-0"
          type="checkbox"
          [checked]="isChecked$(filterKey) | async"
          aria-label="Checkbox for following text input"
          (click)="toggleSelectedFilterKey(filterKey)"
        />
      </div>
      <select
        *ngIf="getFilterValues$(filterKey) | async as fValues; else noValues"
        (focus)="setFilterKey(filterKey)"
        class="form-control col-md-auto"
        [ngClass]="{ current: filterKey === currentFilter }"
        id="filter_key_{{ idx }}"
      >
        <option
        [selected]='filterQueries[filterKey] === ""' value=""
        (click)="setSelectedOption('')"
        (keyup)="setSelectedOption('')"
>
          {{ filterKey }}
        </option>
        <option
          *ngFor="let value of fValues"
          [selected]="filterQueries[filterKey] === value"
          (click)="setSelectedOption(value)"
          (keyup)="setSelectedOption(value)"
          >
          {{ value }}
        </option>
      </select>
      <ng-template #noValues>
        <input
          class="form-control col-md-auto"
          [ngClass]="{ current: filterKey === currentFilter }"
          id="filter_key_{{ idx }}"
          type="search"
          [placeholder]="filterKey"
          [value]="getFilterQuery$(filterKey) | async"
          (focus)="setFilterKey(filterKey)"
          (keyup)="setFilterQuery('filter_key_' + idx)"
        />
      </ng-template>
    </div>
  </div>
</div>
